!function(r){var d={},l=dbmovies.ajaxurl,o=dbmovies.dapiurl,m=dbmovies.tapiurl,n=dbmovies.dapikey,p=dbmovies.tapikey,c=dbmovies.apilang,t=dbmovies.safemod,i=dbmovies.extimer,a=dbmovies.inscrll,v=dbmovies.rscroll,e=dbmovies.csectin,b=dbmovies.nocrdt,u=dbmovies.gerepis,s="#dbmovies-generartor",g="#dbmovies-updaterpost",f="#dbmovies-json-response",h="#dbmovies-importer",_="#dbmovies-generator-seasons",C="#dbmovies-generator-episodes",y="#dbmovies-imdb-updater-page";r(function(){d.GenerateSeEp(),d.PostGenerateSeEp(),d.GenerateAllEpisodesGet(),d.UpdaterEditorPost(),d.GenerateEditor(),d.NavSettings(),d.SaveSettings(),d.GoTop(),d.LogCollapse(),d.Auth(),d.IMDbUpdater(),d.CodeStarTab(),d.Application(),d.Search(),d.Filter(),d.LoadMore(),d.Importer(),d.Cimport(),d.GeneratorSeasons(),d.GeneratorEpisodes(),d.ReubicateForm()}),d.GenerateSeEp=function(){r(document).on("click","#dbmvseaepbtncl",function(){var e=r("#dbmvgsepare").val();return r("#dbgesbtn_"+e).show(),r("#dbmvs_seaepi_generator").hide(),setTimeout(function(){r("#dbmvseaepbtncl").addClass("hidden"),r("#dbmvseaepico").removeClass("done"),r("#dbmvseaepico").addClass("loading"),r("#dbmvseaeprgrs").removeClass("flashit"),r("#dbmvgseitem").val("1"),r("#dbmvgsetmdb").val(""),r("#dbmvgsetotl").val(""),r("#dbmvgsepare").val(""),r("#dbmvgsetype").val(""),r("#dbmvgsename").val(""),r("#dbmvgseseas").val("")},700),!1}),r(document).on("click",".dbmvsarchiveseep",function(){var a,s,t,i;return n&&(r(this).hide(),r("#dbmvs_seaepi_generator").show(),a=r(this).data("parent"),s=r(this).data("tmdb"),t=r(this).data("season"),i=r(this).data("type"),r.getJSON(o+"/?auth="+n,function(e){r("#dbmvgsepare").val(a),r("#dbmvgsetmdb").val(s),r("#dbmvgsetype").val(i),r("#dbmvgseseas").val(t),(1==e.status&&1<=e.credits||1==e.status&&1==e.unlimited)&&r.getJSON(m+"/tv/"+s+"?language="+c+"&api_key="+p,function(e){var a=e.name?e.name:e.original_name;switch(r("#dbmvgsename").val(a),i){case"seasons":r("#dbmvgsetotl").val(e.number_of_seasons);break;case"episodes":r.each(e.seasons,function(e,a){t==a.season_number&&r("#dbmvgsetotl").val(a.episode_count)})}r("#dbmvseaeptxt").html(""),r("#dbmvseaeprgrs").show(),r("#dbmvseaeprgrs").addClass("flashit"),r("#dbmvseaepbtncl").removeClass("hidden"),r("#dbmvseaepico").removeClass("loading"),r("#dbmvseaepico").addClass("done"),r("#dbmvseaepbtn").prop("disabled",!1)})})),!1})},d.PostGenerateSeEp=function(){r(document).on("submit","#dbmvseaepigenerator",function(){var s=r("#dbmvgsepare").val(),t=r("#dbmvgsetmdb").val(),i=parseInt(r("#dbmvgseitem").val()),o=parseInt(r("#dbmvgsetotl").val()),n=i/o*100;return r("#dbmvseaepbtn").hide(),r("#dbmvseaepbtncl").addClass("hidden"),r("#dbmvseaeprgrs").removeClass("flashit"),r("#dbmvseaepico").removeClass("done"),r("#dbmvseaepico").addClass("loading"),r("#dbmvseaeptxt").addClass("flashit"),r("#dbmvseaeptxt").html(dbmovies.loading),r("#gnrtse_"+s).html(dbmovies.prsseng),r.ajax({url:l,type:"POST",dataType:"json",data:r(this).serialize(),success:function(e){var a;r("#dbmvgseitem").val(i+1),1==e.response?(a=i+" / "+o+" >> "+e.title+" >> "+e.mtime,console.log(a),r("#dbmvgseconsolelog").html(a),r("#dbmvseaeprgrs > span").animate({width:n+"%"},150,function(){}),i<o?setTimeout(function(){r("#dbmvseaepbtn").trigger("click")},100):d.PostGenerateSeEpFix(s,t)):d.PostGenerateSeEpFix(s,t)}}),!1})},d.PostGenerateSeEpFix=function(e,a){setTimeout(function(){r("#dbmvgseconsolelog").html(""),r("#dbmvgseitem").val("1"),r("#dbmvs_seaepi_generator").hide(),r("#dbmvseaeprgrs").hide(),r("#dbmvseaepbtn").show(),r("#gnrtse_"+e).html('<code class="ready">'+a+"</code>"),r("#dbmvseaepbtn").prop("disabled",!0),r("#dbmvseaeptxt").removeClass("flashit"),r("#dbmvseaeprgrs > span").animate({width:"0%"},200,function(){})},300)},d.GenerateAllEpisodesGet=function(){"all"==u&&r(document).ready(function(){r("#dbmovies-generator-epprepa").trigger("click")}),r(document).on("click",".dbmvs_generate_episodes",function(){r(this).hide()})},d.UpdaterEditorPost=function(){1==r(g).length&&r(document).on("click",g,function(){r("#dbmovies-message").remove(),r("#api_table").addClass("hidden_api"),r("#loading_api").html('<p><span class="spinner"></span>'+dbmovies.loading+"</p>"),n?r.getJSON(o+"/?auth="+n,function(e){if(1==e.status&&1<=e.credits||1==e.status&&1==e.unlimited){var a=r("#post_type").val(),s=r("#ids").val(),t=r("#temporada").val(),i=r("#episodio").val();switch(a){case"movies":d.UpdateEditorMovies(s);break;case"tvshows":d.UpdateEditorTVShows(s);break;case"seasons":d.UpdateEditorSeasons(s,t);break;case"episodes":d.UpdateEditorEpisodes(s,t,i)}}else e.error?d.ErrorNoticeEditor(e.error):d.ErrorNoticeEditor(b)}).fail(function(){d.ErrorNoticeEditor(dbmovies.dbmverr)}):d.ErrorNoticeEditor(dbmovies.misskey)})},d.SetPostContent=function(e){var a,s;e&&"undefined"!=typeof tinymce&&(a=r("textarea#content").val(),(s=tinymce.get("content"))&&s instanceof tinymce.Editor?'<p><br data-mce-bogus="1"></p>'==s.startContent&&(s.setContent(e),s.save({no_events:!0})):a||r("textarea#content").val(e))},d.SetPostImages=function(e){var s;!r("#imagenes").val()&&e&&(s="",r.each(e,function(e,a){if(9<e)return!1;s+=9==e?a.file_path:a.file_path+"\n"}),r("#imagenes").val(s))},d.TitleReplace=function(e,a,s,t,i){return e.replace("{name}",a).replace("{season}",t).replace("{episode}",i).replace("{year}",s)},d.ImagePreUpload=function(e){1==dbmovies.pupload&&e&&0==r("#postimagediv p img").length&&r("#postimagediv p").html('<ul><li><img src="https://image.tmdb.org/t/p/w500'+e+'"/> </li></ul>')},d.UpdateEditorMovies=function(e){var a=m+"/movie/"+e;apilan="?language="+c,imglan="&include_image_language="+c,aditin=",null&append_to_response=images&api_key="+p,r.getJSON(a.concat(apilan,imglan,aditin),function(e){d.SetPostContent(e.overview),d.SetPostImages(e.images.backdrops),r("#dt_poster").val(e.poster_path),r("#dt_backdrop").val(e.backdrop_path),r("#idtmdb").val(e.id),r("#original_title").val(e.original_title),r("#tagline").val(e.tagline),r("#release_date").val(e.release_date),r("#vote_average").val(e.vote_average),r("#vote_count").val(e.vote_count),r("#runtime").val(e.runtime)}),r.getJSON(o+"/?key="+n+"&imdb="+e,function(e){r("#imdbRating").val(e.rating),r("#imdbVotes").val(e.votes),r("#Rated").val(e.rated),r("#Country").val(e.country)}),d.ErrorFixedEditor()},d.UpdateEditorTVShows=function(e){var a=m+"/tv/"+e;apilan="?language="+c,imglan="&include_image_language="+c,aditin=",null&append_to_response=images&api_key="+p,r.getJSON(a.concat(apilan,imglan,aditin),function(e){d.SetPostContent(e.overview),d.SetPostImages(e.images.backdrops),r("#dt_poster").val(e.poster_path),r("#dt_backdrop").val(e.backdrop_path),r("#original_name").val(e.original_name),r("#first_air_date").val(e.first_air_date),r("#last_air_date").val(e.last_air_date),r("#number_of_seasons").val(e.number_of_seasons),r("#number_of_episodes").val(e.number_of_episodes),r("#imdbRating").val(e.vote_average),r("#imdbVotes").val(e.vote_count),r("#episode_run_time").val(e.episode_run_time[0])}),d.ErrorFixedEditor()},d.UpdateEditorSeasons=function(e,s){var a=m+"/tv/"+e;apilan="?language="+c,aditin="&api_key="+p,r.getJSON(a.concat(apilan,aditin),function(e){r("#serie").val(e.name),r("#title").val()||(r("label#title-prompt-text").addClass("screen-reader-text"),r("#title").val(d.TitleReplace(dbmovies.titseas,e.name,null,s,null))),r.each(e.seasons,function(e,a){s==a.season_number&&(d.SetPostContent(a.overview),d.ImagePreUpload(a.poster_path),r("#dt_poster").val(a.poster_path),r("#air_date").val(a.air_date))})}),d.ErrorFixedEditor()},d.UpdateEditorEpisodes=function(e,s,t){var a=m+"/tv/"+e;apiuep=m+"/tv/"+e+"/season/"+s+"/episode/"+t,apilan="?language="+c,aditin="&api_key="+p,imglan="&include_image_language="+c,rditin=",null&append_to_response=images&api_key="+p,r.getJSON(a.concat(apilan,aditin),function(e){var a=e.name;title=r("#title").val(),r("#serie").val(a),title||(r("label#title-prompt-text").addClass("screen-reader-text"),r("#title").val(d.TitleReplace(dbmovies.titepis,a,null,s,t)))}),r.getJSON(apiuep.concat(apilan,imglan,rditin),function(e){var s;d.SetPostContent(e.overview),d.ImagePreUpload(e.still_path),r("#episode_name").val(e.name),r("#dt_backdrop").val(e.still_path),r("#air_date").val(e.air_date),!r("#imagenes").val()&&e.images.stills&&(s="",r.each(e.images.stills,function(e,a){if(9<e)return!1;s+=9==e?a.file_path:a.file_path+"\n"}),r("#imagenes").val(s))}),d.ErrorFixedEditor()},d.GenerateEditor=function(){1==r(s).length&&r(document).on("click",s,function(){r("#dbmovies-message").remove(),r("#api_table").addClass("hidden_api"),r("#loading_api").html('<p><span class="spinner"></span>'+dbmovies.loading+"</p>"),n?r.getJSON(o+"/?auth="+n,function(e){if(1==e.status&&1<=e.credits||1==e.status&&1==e.unlimited){var a=r("#post_type").val(),s=r("#post_ID").val(),t=r("#ids").val(),i=r("#temporada").val(),o=r("#episodio").val();switch(a){case"movies":case"tvshows":d.AddMainTitle(s,t,a);break;case"seasons":d.AddSeason(s,t,i,a);break;case"episodes":d.AddEpisode(s,t,i,o,a)}}else e.error?d.ErrorNoticeEditor(e.error):d.ErrorNoticeEditor(b)}).fail(function(){d.ErrorNoticeEditor(dbmovies.dbmverr)}):d.ErrorNoticeEditor(dbmovies.misskey)})},d.AddMainTitle=function(e,a,s){a?r.ajax({url:l,type:"POST",dataType:"json",data:{idpost:e,tmdbid:a,typept:s,action:"dbmovies_genereditor"},success:function(e){1==e.response&&window.location.replace(e.editlink),0==e.response&&d.ErrorNoticeEditor(e.message)}}):d.ErrorFixedEditor()},d.AddSeason=function(a,s,t,i){s&&t?r.getJSON(m+"/tv/"+s+"?language="+c+"&api_key="+p,function(e){r.ajax({url:l,type:"POST",dataType:"json",data:{idpost:a,tmdbid:s,typept:i,season:t,tvname:e.name,action:"dbmovies_genereditor"},success:function(e){1==e.response&&(e.message?d.ErrorNoticeEditor(e.message):window.location.replace(e.editlink)),0==e.response&&d.ErrorNoticeEditor(e.message)}})}).fail(function(){d.ErrorNoticeEditor(dbmovies.tmdberr)}):d.ErrorFixedEditor()},d.AddEpisode=function(a,s,t,i,o){s&&t&&i?r.getJSON(m+"/tv/"+s+"?language="+c+"&api_key="+p,function(e){r.ajax({url:l,type:"POST",dataType:"json",data:{idpost:a,tmdbid:s,typept:o,season:t,episde:i,tvname:e.name,action:"dbmovies_genereditor"},success:function(e){1==e.response&&(e.message?d.ErrorNoticeEditor(e.message):window.location.replace(e.editlink)),0==e.response&&d.ErrorNoticeEditor(e.message)}})}).fail(function(){d.ErrorNoticeEditor(dbmovies.tmdberr)}):d.ErrorFixedEditor()},d.ErrorNoticeEditor=function(e){r("#postbox-container-2").prepend('<div id="dbmovies-message" class="notice notice-warning"><p>'+e+"</p></div>"),r("#loading_api").html(""),r("#api_table").removeClass("hidden_api")},d.ErrorFixedEditor=function(){r("#loading_api").html(""),r("#api_table").removeClass("hidden_api")},d.NavSettings=function(){var a="#dbmvs-nav-settings > li.nav-tab";r(document).on("click",a,function(){var e=r(this).data("tab");return 0!=e&&(r(a).removeClass("nav-tab-active"),r(".tab-content").removeClass("on"),r(this).addClass("nav-tab-active"),r("#dbmv-setting-"+e).addClass("on")),!1})},d.SaveSettings=function(){var a="#dbmvsbtn-savesettings",s="#dbmvsssrespnc";r(document).on("submit","#dbmovies-settings",function(){return r(a).prop("disabled",!0),r(".tab-content").addClass("onprogress"),r.ajax({url:l,type:"POST",dataType:"json",data:r(this).serialize(),success:function(e){n&&1!=e.reload?(r(".tab-content").removeClass("onprogress"),r(s).addClass("fadein"),r(s).html(e.message),setTimeout(function(){r(a).prop("disabled",!1),r(s).html(""),r(s).removeClass("fadein")},1e3)):location.reload()}}),!1})},d.GoTop=function(){var e="#dbmovies-back-top";1==r(e).length&&(r(e).hide(),r(function(){r(window).scroll(function(){200<r(this).scrollTop()?r(e).fadeIn():r(e).fadeOut()}),r(e).click(function(){return r("body,html").animate({scrollTop:0},500),!1})}))},d.LogCollapse=function(){r(document).on("click",".dbmovies-log-collapse",function(){return r(this).toggleClass("expand"),r("#dbmovies-logs-box").toggleClass("expand"),!1})},d.Auth=function(){r.each(["#dbmvs-forms-response","#dbmovies-importer",".dbmovies-tvshow-content-generator"],function(e,a){r(a).length&&(n?r.getJSON(o+"/?auth="+n,function(e){"1"==e.status?(0==e.unlimited&&(r(".dbmvs-credits").show(),r("#dbmvs-credits").html(d.NumberFormat(e.credits))),1<=e.credits||1==e.unlimited?r("#dbmvs-log-indicator").after('<li class="fadein"><span class="type">dbmvs</span>'+dbmovies.welcom+"</li>"):(d.AuthModules(),r("#dbmvs-log-indicator").after('<li class="fadein">'+b+"</li>"))):(d.AuthModules(),r("#dbmvs-log-indicator").after('<li class="fadein">'+e.error+"</li>"))}):(1==r("#dbmovies-dbmvs-application").length&&window.location.replace("admin.php?page=dbmvs-settings"),d.AuthModules()))})},d.AuthModules=function(){r("#dbmvs-forms-response").remove(),r("#dbmovies-importer").remove(),r(".dbmovies-tvshow-content-generator").remove()},d.IMDbUpdater=function(){r(document).on("click","#dbmvs-imdb",function(){var e=parseInt(r(y).val());return r(this).hide(),r("#dbmovies-li-imdb > span.spinner").show(),r("#dbmovies-li-imdb > span.percentage").show(),r.ajax({url:l,type:"POST",dataType:"json",data:{page:e,action:"dbmovies_app_upimdb"},success:function(l){var m=[];1==l.response?(r(y).val(++e),r(".progressing").animate({width:l.prgss+"%"},150,function(){}),r("#dbmovies-li-imdb > span.percentage").html(l.prgss+"%"),r.each(l.imdb,function(e,a){var s=a.imdb,t=a.rating+" - ",i=(a.votes,a.title),o=a.plink,n='<span class="type">'+a.imdb+"</span>",r='<a href="'+o+'">'+i+"</a>",d='<span class="microtime">'+l.mtime+"</span>";s?m.push('<li class="jump">'+n+t+r+d+"</li>"):m.push('<li class="jump"><span class="error">'+a.message+"</span>"+d+"</li>")}),r("#dbmvs-log-indicator").after(m.join("")),setTimeout(function(){r("#dbmvs-imdb").trigger("click")},100)):(r("#dbmovies-li-imdb > span.percentage").hide(),r("#dbmovies-li-imdb > span.spinner").hide(),r("#dbmvs-imdb").show(),r(".progressing").animate({width:"0%"},4e3,function(){}))}}),!1})},d.CodeStarTab=function(){e&&(r(".cs-section").hide(),r(".cs-nav ul a").removeClass("cs-section-active"),r("#tab-"+e).addClass("cs-section-active"),r("#cs-tab-"+e).show())},d.ReubicateForm=function(){var e,a="#dbmvoies-importer-html";1==r(a).length&&(e=r(a).html(),r(".wp-header-end").after(e),r(a).remove())},d.Application=function(){var a=".dbmvs-tab-content";r(document).on("click",a,function(){var e;return r(this).hasClass("button-primary")||(e=r(this).data("type"),r(".genres").removeClass("on"),r("#genres-box-"+e).addClass("on"),r("#dbmvs-filter-type").val(e),r("#dbmvs-search-type").val(e),r(a).removeClass("button-primary"),r(this).addClass("button-primary"),d.FixingApiResults()),!1})},d.Cimport=function(){r.each(["#dbmvs-year","#dbmvs-movies-genres","#dbmvs-tvshows-genres","#dbmvs-filter-type","#dbmvs-popularity","#dbmvs-search-term"],function(e,a){r(document).on("change",a,function(){d.FixingApiResults()})}),r(document).on("click","#bulk-importer",function(){return r("#bulk-importer-click").hide(),r(".cimport").each(function(){var e=r(this),a=e.data("type"),s=e.data("tmdb");return e.hide(),e.removeClass("cimport"),r("#tmdb-"+s).removeClass("non-existent"),r("#tmdb-"+s).addClass("onload fadein"),d.TMDbAppImport(a,s,!0,t),!1}),!1}),r(document).on("click",".cimport",function(){var e=r(this),a=e.data("type"),s=e.data("tmdb");return e.hide(),e.removeClass("cimport"),r("#tmdb-"+s).removeClass("non-existent"),r("#tmdb-"+s).addClass("onload fadein"),d.TMDbAppImport(a,s,!1,!1),!1})},d.FixingApiResults=function(){r("#dbmovies-loadmore").removeClass("search"),r("#dbmovies-loadmore").removeClass("filter"),r("#dbmvs-results-number").html(0),r("#bulk-importer-click").hide(),r("#dbmovies-loadmore").hide(),r("#dbmvs-page").val(1),r("#dbmvs-search-page").val(1),r(".item").remove()},d.TMDbAppImport=function(e,a,s,t){s&&!t&&setTimeout(function(){r("#bulk-importer").trigger("click")},i),r.ajax({url:l,type:"POST",dataType:"json",data:{ptype:e,ptmdb:a,action:"dbmovies_insert_tmdb"},success:function(e){d.ComposeItemLog(e),1==e.response?(r("#tmdb-"+a).removeClass("onload"),r("#tmdb-"+a).addClass("existent jump"),t&&r("#bulk-importer").trigger("click")):(r("#tmdb-"+a).removeClass("onload"),r("#tmdb-"+a).addClass("error"),r("#cimprt-"+a).addClass("cimport"),r("#cimprt-"+a).show())}})},d.Search=function(){r(document).on("submit","#dbmovies-form-search",function(){return r("#dbmvs-btn-search").prop("disabled",!0),r("#dbmovies-loadmore").addClass("search disabled"),r("#dbmovies-loadmore").hide(),r("#dbmovies-loadmore-spinner").show(),r.ajax({url:l,type:"POST",dataType:"json",data:r(this).serialize(),success:function(e){var a=parseInt(r("#dbmvs-search-page").val());r("#current-page").val(e.page),r("#current-year").val(e.year),r("#dtotal-items").val(e.items),r("#dbmvs-results-number").html(d.NumberFormat(e.total)),r("#dbmovies-loadmore-spinner").hide(),r("#dbmovies-loadmore").removeClass("disabled"),d.ComposeFilterLog(e),1==e.response&&(a<e.pages?r("#dbmovies-loadmore").show():r("#dbmovies-loadmore").removeClass("search"),r("#dbmvs-btn-search").prop("disabled",!1),d.ComposeResults(e.results)),0==e.response&&d.FixingApiResults()}}),!1})},d.Filter=function(){r("#current-page").val(),r("#current-year").val();r(document).on("submit","#dbmovies-form-filter",function(){return r("#bulk-importer-click").hide(),r("#dbmovies-loadmore").hide(),r("#dbmovies-loadmore").addClass("filter disabled"),r("#dbmvs-btn-filter").prop("disabled",!0),r("#dbmovies-loadmore-spinner").show(),r.ajax({url:l,type:"POST",dataType:"json",data:r(this).serialize(),success:function(e){var a=parseInt(r("#dbmvs-page").val());r("#current-page").val(e.page),r("#current-year").val(e.year),r("#dtotal-items").val(e.items),r("#dbmvs-results-number").html(d.NumberFormat(e.total)),r("#dbmovies-loadmore").removeClass("disabled"),d.ComposeFilterLog(e),r("#dbmovies-loadmore-spinner").hide(),1==e.response&&(a<e.pages&&r("#dbmovies-loadmore").show(),r("#bulk-importer-click").show(),r("#dbmvs-btn-filter").prop("disabled",!1),d.ComposeResults(e.results)),0==e.response&&(alert(e.message),r("#dbmvs-btn-filter").prop("disabled",!1),d.FixingApiResults())}}),!1})},d.ComposeResults=function(e){var o=[];r.each(e,function(e,a){var s,t,i;r("#tmdb-"+a.id).length||(s="","non-existent"==a.db&&(s='<div id="cimprt-'+a.id+'" class="cimport" data-tmdb="'+a.id+'" data-type="'+a.tp+'"></div>'),t='<div class="image"><img src="'+a.im+'">'+s+"</div>",i='<div class="data"><h3>'+a.ti+"</h3><span>"+a.dt+"</span></div>",o.push('<div class="item fadein"><article class="'+a.db+'" id="tmdb-'+a.id+'">'+t+i+"</article></div>"))}),r("#response-dbmovies").before(o.join(""))},d.ComposeItemLog=function(e){var a,s,t="";t=1==e.response?(a='<span class="type">'+e.type+"</span>",s='<a href="'+e.permalink+'" target="_blank">'+e.title+"</a>",a+('<span class="edit"><a href="'+e.editlink+'" target="_blank">'+dbmovies.editxt+"</a></span>")+s+('<span class="microtime">'+e.mtime+"</span>")):e.message,r("#dbmvs-log-indicator").after('<li class="fadein">'+t+"</li>")},d.ComposeFilterLog=function(e){var a,s,t="";t=1==e.response?(a='<span class="type">'+e.type+"</span>",s='<span class="microtime">'+e.mtime+"</span>",a+dbmovies.complt+s):e.message,r("#dbmvs-log-indicator").after('<li class="fadein">'+t+"</li>")},d.LoadMore=function(){r.each([".dbmvsloadmore.search",".dbmvsloadmore.filter"],function(e,s){r(document).on("click",s,function(){var e;return".dbmvsloadmore.filter"==s&&(e=parseInt(r("#dbmvs-page").val())),".dbmvsloadmore.search"==s&&(e=parseInt(r("#dbmvs-page").val())),e&&!r(this).hasClass("disabled")&&(".dbmvsloadmore.filter"==s&&(r("#dbmvs-page").val(++e),r("#dbmvs-btn-filter").trigger("click")),".dbmvsloadmore.search"==s&&(r("#dbmvs-search-page").val(++e),r("#dbmvs-btn-search").trigger("click"))),!1}),a&&r(window).scroll(function(){var e=r(this),a=r(".wrapp");r("#dtotal-items").val()<parseInt(v)&&e.scrollTop()>=a.height()-e.height()+240&&(r("#dbmovies-loadmore").hasClass("disabled")||setTimeout(function(){r(s).trigger("click")},500))})})},d.Importer=function(){1==r(h).length&&r(document).on("submit",h,function(){var a="#dbmovies-btn-importer",s="#dbmovies-inp-tmdb";return r(a).prop("disabled",!0),r(s).addClass("disabled"),r(a).val(dbmovies.loading),r(".wp-list-table").addClass("onprogress"),r(h).addClass("onprogress"),r("#dbmovies-loader").addClass("is-active"),r.ajax({url:l,type:"POST",dataType:"json",data:r(this).serialize(),success:function(e){1==e.response?window.location.replace(e.editlink):(alert(e.message),r(a).prop("disabled",!1),r(s).removeClass("disabled"),r(a).val(dbmovies.import),r(h).removeClass("onprogress"),r(".wp-list-table").removeClass("onprogress"),r("#dbmovies-loader").removeClass("is-active"))}}),!1})},d.GeneratorSeasons=function(){var o=r("#ids").val();r(document).on("click","#dbmovies-generator-seprepa",function(){var e=r("#tmdbseasos").val(),a=r("#tmdbsename").val();return r(this).prop("disabled",!0),e||a||r.getJSON(m+"/tv/"+o+"?language="+c+"&api_key="+p,function(e){var a=e.name?e.name:e.original_name;r("#tmdbsename").val(a),r.each(e,function(e,a){"number_of_seasons"==e&&(r("#tmdbseasos").val(a),r("#number_of_seasons").val(a),r("#dbmovies-json-response").html("0/"+a)),"number_of_episodes"==e&&r("#number_of_episodes").val(a)}),r("#dbmovies-generator-seprepa").removeClass("button-primary"),r(_).removeClass("button-secundary"),r(_).addClass("button-primary"),r(_).prop("disabled",!1)}),!1}),r(document).on("click",_,function(){var e=parseInt(r("#tmdbseason").val()),a=parseInt(r("#tmdbseasos").val()),s=r("#tmdbsename").val(),t=r("#postparent").val(),i=(e-1)/a*100;return r(this).prop("disabled",!0),r(this).hide(300),r("#dbmovies-loader").addClass("is-active"),d.Progress(i),e<=a?(r("#tmdbseason").val(e+1),r(f).html(e+"/"+a),r.ajax({url:l,type:"POST",dataType:"json",data:{tmdb:o,tmse:e,name:s,post:t,action:"dbmovies_generate_se"},success:function(e){1==e.response?(console.log(e.title+" - "+e.mtime),r(_).prop("disabled",!1),setTimeout(function(){r(_).trigger("click")},75)):location.reload()}})):location.reload(),!1})},d.GeneratorEpisodes=function(){var o=r("#ids").val(),n=r("#temporada").val();r(document).on("click","#dbmovies-generator-epprepa",function(){r("#tmdbepisos").val(),r("#tmdbsename").val();return r(this).prop("disabled",!0),r.getJSON(m+"/tv/"+o+"?language="+c+"&api_key="+p,function(t){r.each(t.seasons,function(e,a){var s;n==a.season_number&&(s=t.name?t.name:t.original_name,r("#tmdbsename").val(s),r("#tmdbepisos").val(a.episode_count),r("#dbmovies-json-response").html("0/"+a.episode_count))}),r("#dbmovies-generator-epprepa").removeClass("button-primary"),r(C).removeClass("button-secundary"),r(C).addClass("button-primary"),r(C).prop("disabled",!1),"all"==u&&setTimeout(function(){r(C).trigger("click")},1500)}),!1}),r(document).on("click",C,function(){var e=parseInt(r("#tmdbepisod").val()),a=parseInt(r("#tmdbepisos").val()),s=r("#tmdbsename").val(),t=r("#postparent").val(),i=(e-1)/a*100;return r(this).prop("disabled",!0),r(this).hide(300),r("#dbmovies-loader").addClass("is-active"),d.Progress(i),e<=a?(r("#tmdbepisod").val(e+1),r(f).html(e+"/"+a),r.ajax({url:l,type:"POST",dataType:"json",data:{tmdb:o,tmse:n,tmep:e,name:s,post:t,action:"dbmovies_generate_ep"},success:function(e){1==e.response?(console.log(e.title+" - "+e.mtime),r(C).prop("disabled",!1),setTimeout(function(){r(C).trigger("click")},75)):"all"==u?window.close():location.reload()}})):"all"==u?window.close():location.reload(),!1})},d.Progress=function(e){r("#dbmovies-progress").animate({width:e+"%"},150,function(){})},d.NumberFormat=function(e){x=(e+="").split("."),x1=x[0],x2=1<x.length?"."+x[1]:"";for(var a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}}(jQuery);
